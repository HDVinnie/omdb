"use strict";function $AnchorScrollProvider(){var a=!0;this.disableAutoScrolling=function(){a=!1},this.$get=["$window","$location","$rootScope",function(b,c,d){function e(a){var b=null;return forEach(a,function(a){b||"a"!==nodeName_(a)||(b=a)}),b}function f(){var a,d=c.hash();d?(a=g.getElementById(d))?a.scrollIntoView():(a=e(g.getElementsByName(d)))?a.scrollIntoView():"top"===d&&b.scrollTo(0,0):b.scrollTo(0,0)}var g=b.document;return a&&d.$watch(function(){return c.hash()},function(){d.$evalAsync(f)}),f}]}angular.module("omdbApp",["ngAnimate","ngResource","ngRoute"]).config(["$routeProvider",function(a){a.when("/",{templateUrl:"views/home.html",controller:"HomeCtrl"}).when("/search/:query",{templateUrl:"views/search.html",controller:"SearchCtrl"}).when("/title/:id/:type",{templateUrl:"views/details-title.html",controller:"DetailsTitleCtrl"}).when("/name/:id",{templateUrl:"views/details-name.html",controller:"DetailsNameCtrl"}).otherwise({redirectTo:"/"})}]).value("APIKey","5d967417393b991110d125b2c51affe5").value("APIURL","http://api.themoviedb.org/3/"),angular.module("omdbApp").factory("config",["$http","APIURL","APIKey",function(a,b,c){var d={images:{base_url:"http://image.tmdb.org/t/p/",secure_base_url:"https://image.tmdb.org/t/p/",backdrop_sizes:["w300","w780","w1280","original"],logo_sizes:["w45","w92","w154","w185","w300","w500","original"],poster_sizes:["w92","w154","w185","w342","w500","w780","original"],profile_sizes:["w45","w185","h632","original"],still_sizes:["w92","w185","w300","original"]},change_keys:["adult","also_known_as","alternative_titles","biography","birthday","budget","cast","character_names","crew","deathday","general","genres","homepage","images","imdb_id","name","original_title","overview","plot_keywords","production_companies","production_countries","releases","revenue","runtime","spoken_languages","status","tagline","title","trailers","translations"]},e={loadConfig:function(){console.log("Load config called");var e=localStorage.getItem("configuration");try{e=JSON.parse(e)}catch(f){console.log(f),e=null,localStorage.setItem("configuration",null)}e&&void 0!==e&&null!==e?(console.log("Got config from storage"),d=e):a({method:"GET",url:b+"configuration",params:{api_key:c}}).success(function(a){console.log("Got config from API and put in storage"),localStorage.setItem("configuration",JSON.stringify(a)),d=a}).error(function(a){console.log(a)})},getConfig:function(){return d},getImagePath:function(a,b){var c="";return c="original"!==b?d.images[a+"_sizes"][b]:"original",d.images.base_url+c}};return e.loadConfig(),e}]),angular.module("omdbApp").factory("api",["$http","APIURL","APIKey",function(a,b,c){var d={simpleRequest:function(e,f,g){null!==g&&"object"==typeof g?g.api_key=c:g={api_key:c},a({method:"GET",url:b+e,params:g}).success(function(a){f(a)}).error(function(a){d.error(a)})},movies:{id:function(a,b){d.simpleRequest("movie/"+a,b,{append_to_response:"credits,images,similar,videos"})},playing:function(a){d.simpleRequest("movie/now_playing",a)},popular:function(a){d.simpleRequest("movie/popular",a)},search:function(a,b){d.simpleRequest("search/movie",b,{query:a})},autocomplete:function(a,b){d.simpleRequest("search/movie",b,{query:a,search_type:"ngram"})}},tv:{id:function(a,b){d.simpleRequest("tv/"+a,b,{append_to_response:"credits,images,similar,videos"})},popular:function(a){d.simpleRequest("tv/popular",a)},airingToday:function(a){d.simpleRequest("tv/airing_today",a)},topRated:function(a){d.simpleRequest("tv/top_rated",a)},search:function(a,b){d.simpleRequest("search/tv",b,{query:a})},autocomplete:function(a,b){d.simpleRequest("search/tv",b,{query:a,search_type:"ngram"})}},people:{popular:function(a){d.simpleRequest("person/popular",a)},search:function(a,b){d.simpleRequest("search/person",b,{query:a})},autocomplete:function(a,b){d.simpleRequest("search/person",b,{query:a,search_type:"ngram"})}},error:function(a){console.log("error"),console.log(a)}};return d}]),angular.module("omdbApp").controller("AppCtrl",["$scope","$rootScope","$location","$http","$timeout","$window","config","api",function(a,b,c,d,e,f,g,h){a.posterPath=g.getImagePath("poster",0),a.profilePath=g.getImagePath("profile",0),a.showAutocomplete=!1,a.autocompleteMovies=[],a.autocompleteTvShows=[],a.autocompletePeople=[],a.activateAutocomplete=function(){a.showAutocomplete=!0,j()},a.hideAutocomplete=function(){e(function(){a.showAutocomplete=!1},150)};var i=a.query,j=function(){e(function(){i!==a.query&&(i=a.query,a.query.length>2?(h.movies.autocomplete(a.query,function(b){a.autocompleteMovies=b.results.splice(0,3)}),h.people.autocomplete(a.query,function(b){a.autocompletePeople=b.results.splice(0,3)}),h.tv.autocomplete(a.query,function(b){a.autocompleteTvShows=b.results.splice(0,3)})):(a.autocompleteMovies=[],a.autocompleteTvShows=[],a.autocompletePeople=[])),a.showAutocomplete&&j()},1e3)};a.search=function(){c.path("search/"+a.query),a.hideAutocomplete()},b.$watch("query",function(){a.query=b.query})}]),angular.module("omdbApp").controller("HomeCtrl",["$scope","$rootScope","$http","$location","config","api",function(a,b,c,d,e,f){a.posterPath=e.getImagePath("poster",2),a.profilePath=e.getImagePath("profile",2),f.movies.playing(function(b){a.playing=b.results,a.playingCount=b.total_results}),f.movies.popular(function(b){a.popularMovies=b.results,a.popularMoviesCount=b.total_results}),f.people.popular(function(b){a.popularPeople=b.results,a.popularPeopleCount=b.total_results})}]),angular.module("omdbApp").controller("SearchCtrl",["$scope","$rootScope","$routeParams","$location","$http","config","api",function(a,b,c,d,e,f,g){c.query?b.query=c.query:d.path(""),a.posterPath=f.getImagePath("poster",1),a.profilePath=f.getImagePath("profile",1),a.movies=[],a.tvShows=[],a.people=[],g.movies.autocomplete(c.query,function(b){a.movies=b.results,a.moviesCount=b.total_results}),g.tv.autocomplete(c.query,function(b){a.tvShows=b.results,a.tvShowsCount=b.total_results}),g.people.autocomplete(c.query,function(b){a.people=b.results,a.peopleCount=b.total_results})}]),angular.module("omdbApp").controller("DetailsTitleCtrl",["$scope","$rootScope","$routeParams","$location","$http","$timeout","$sce","config","api",function(a,b,c,d,e,f,g,h,i){switch(c.id||d.path(""),a.type=c.type||"movie",a.backdropPath=h.getImagePath("backdrop","original"),a.posterPath=h.getImagePath("poster",3),a.profilePath=h.getImagePath("profile",3),a.type){case"tv":var j="tv";break;default:var j="movies"}i[j].id(c.id,function(c){console.log(c),a.details=c,a.images=c.images,b.query=c.title||c.name,a.backdrops=[],a.images.backdrops.forEach(function(b){b.width>1e3&&a.backdrops.push(b)}),0!==a.backdrops.length&&(b.translucentMenu=!0),a.backdropIndex=0,a.changeBackdrop(),a.stars=[0,0,0,0,0];for(var d=a.details.vote_average/2,e=0;5>e;e++)console.log("vote_copy is nu "+d),console.log("Math.round(vote_copy) is nu "+Math.round(d)),d>=1?(console.log("Give star #"+(e+1)),a.stars[e]=2):1===Math.round(d)&&(a.stars[e]=1,console.log("Give half star #"+(e+1))),d--;a.trailerYoutube=!1,a.showTrailer=!1,a.details.videos.results.forEach(function(b){"YouTube"===b.site&&"Trailer"===b.type&&(a.trailerYoutube=b)}),a.details.release_date&&a.sidebarDetails.push({label:"Release date",value:a.details.release_date}),a.details.runtime&&a.sidebarDetails.push({label:"Runtime",value:a.details.runtime+" minutes"}),a.details.seasons&&a.details.seasons.length>0&&a.sidebarDetails.push({label:"Number of seasons",value:a.details.seasons.length}),a.details.networks&&a.details.networks.length>0&&a.sidebarDetails.push({label:"Networks",value:a.details.networks.map(function(a){return a.name}).join("\n")}),a.details.genres&&a.details.genres.length>0&&a.sidebarDetails.push({label:"Genres",value:a.details.genres.map(function(a){return a.name}).join(", ")}),a.details.production_companies&&a.details.production_companies.length>0&&a.sidebarDetails.push({label:"Production companies",value:a.details.production_companies.map(function(a){return a.name}).join(", ")}),a.details.production_countries&&a.details.production_countries.length>0&&a.sidebarDetails.push({label:"Production countries",value:a.details.production_countries.map(function(a){return a.name}).join(", ")}),a.details.spoken_languages&&a.details.spoken_languages.length>0&&a.sidebarDetails.push({label:"Spoken languages",value:a.details.spoken_languages.map(function(a){return a.name}).join(", ")}),a.details.budget&&a.sidebarDetails.push({label:"Budget",value:"$"+a.details.budget.toString().replace(/(\d{1,3})(?=(?:\d{3})+$)/g,"$1,")}),a.details.revenue&&a.sidebarDetails.push({label:"Revenue",value:"$"+a.details.revenue.toString().replace(/(\d{1,3})(?=(?:\d{3})+$)/g,"$1,")})}),a.trustSrc=function(a){return g.trustAsResourceUrl(a)},a.showFullOverview=!1,a.toggleFullOverview=function(){a.showFullOverview=!a.showFullOverview},a.showFullOverview=!1,a.toggleFullOverview=function(){a.showFullOverview=!a.showFullOverview},a.sidebarDetails=[],a.showFullDetailsSidebar=!1,a.toggleFullDetailsSidebar=function(){a.showFullDetailsSidebar=!a.showFullDetailsSidebar},a.changeBackdrop=function(){f(function(){a.backdropIndex<a.backdrops.length-1?a.backdropIndex++:a.backdropIndex=0,a.changeBackdrop()},12e3)},a.prevBackdrop=function(){a.backdropIndex>0?a.backdropIndex--:a.backdropIndex=a.backdrops.length-1},a.nextBackdrop=function(){a.backdropIndex<a.backdrops.length-1?a.backdropIndex++:a.backdropIndex=0},a.$on("$destroy",function(){b.translucentMenu=!1,f.cancel()})}]),angular.module("omdbApp").controller("DetailsNameCtrl",["$scope","$rootScope","$routeParams","$location","$http","$timeout","config","APIKey","APIURL",function(a,b,c,d,e,f,g,h,i){c.id||d.path(""),a.backdropPath=g.getConfig().images.base_url+"original",a.posterPath=g.getConfig().images.base_url+"original",a.profilePath=g.getConfig().images.base_url+g.getConfig().images.profile_sizes[1],e({method:"GET",url:i+"person/"+c.id,params:{api_key:h,append_to_response:"combined_credits,images,tagged_images"}}).success(function(c){console.log(c),a.details=c,a.images=c.images,b.query=c.name,a.backdrops=[],c.tagged_images.results.forEach(function(b){"backdrop"===b.image_type&&a.backdrops.push(b)}),0!==a.backdrops.length&&(b.translucentMenu=!0),a.backdropIndex=0,a.changeBackdrop()}).error(function(a){console.log(a)}),a.showFullBio=!1,a.toggleFullBio=function(){a.showFullBio=!a.showFullBio},a.changeBackdrop=function(){f(function(){a.backdropIndex<a.backdrops.length-1?a.backdropIndex++:a.backdropIndex=0,a.changeBackdrop()},12e3)},a.prevBackdrop=function(){a.backdropIndex>0?a.backdropIndex--:a.backdropIndex=a.backdrops.length-1},a.nextBackdrop=function(){a.backdropIndex<a.backdrops.length-1?a.backdropIndex++:a.backdropIndex=0},a.$on("$destroy",function(){b.translucentMenu=!1,f.cancel()})}]);