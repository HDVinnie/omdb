"use strict";function $AnchorScrollProvider(){var a=!0;this.disableAutoScrolling=function(){a=!1},this.$get=["$window","$location","$rootScope",function(b,c,d){function e(a){var b=null;return forEach(a,function(a){b||"a"!==nodeName_(a)||(b=a)}),b}function f(){var a,d=c.hash();d?(a=g.getElementById(d))?a.scrollIntoView():(a=e(g.getElementsByName(d)))?a.scrollIntoView():"top"===d&&b.scrollTo(0,0):b.scrollTo(0,0)}var g=b.document;return a&&d.$watch(function(){return c.hash()},function(){d.$evalAsync(f)}),f}]}angular.module("omdbApp",["ngAnimate","ngResource","ngRoute"]).config(["$routeProvider",function(a){a.when("/",{templateUrl:"views/home.html",controller:"HomeCtrl"}).when("/search/:query",{templateUrl:"views/search.html",controller:"SearchCtrl"}).when("/title/:id/:type",{templateUrl:"views/details-movie.html",controller:"DetailsMovieCtrl"}).when("/name/:id",{templateUrl:"views/details-person.html",controller:"DetailsPersonCtrl"}).otherwise({redirectTo:"/"})}]).value("APIKey","5d967417393b991110d125b2c51affe5").value("APIURL","http://api.themoviedb.org/3/"),angular.module("omdbApp").controller("AppCtrl",["$scope","$rootScope","$location","$http","$timeout","$window","APIURL","APIKey",function(a,b,c,d,e,f,g,h){b.config=localStorage.getItem("configuration");try{b.config=JSON.parse(b.config),console.log(b.config)}catch(i){console.log(i)}b.config&&void 0!==b.config&&null!==b.config?(a.posterPath=b.config.images.base_url+b.config.images.poster_sizes[0],a.profilePath=b.config.images.base_url+b.config.images.profile_sizes[0]):d({method:"GET",url:g+"configuration",params:{api_key:h}}).success(function(a){localStorage.setItem("configuration",JSON.stringify(a)),b.config=a,f.location.reload()}).error(function(a){console.log(a),alert("error getting config")}),a.showAutocomplete=!1,a.autocompleteMovies=[],a.autocompleteTvShows=[],a.autocompletePeople=[],a.search=function(){c.path("search/"+a.query),a.hideAutocomplete()},a.hideAutocomplete=function(){e(function(){a.showAutocomplete=!1},150)},a.activateAutocomplete=function(){console.log("Autocomplete activated"),a.showAutocomplete=!0,k()};var j=a.query,k=function(){e(function(){j!==a.query&&(j=a.query,a.query.length>2?(d({method:"GET",url:g+"search/movie",params:{api_key:h,query:a.query,search_type:"ngram"}}).success(function(b){a.autocompleteMovies=b.results.splice(0,3)}).error(function(){a.autocompleteMovies=[]}),d({method:"GET",url:g+"search/person",params:{api_key:h,query:a.query,search_type:"ngram"}}).success(function(b){a.autocompletePeople=b.results.splice(0,3)}).error(function(){a.autocompletePeople=[]}),d({method:"GET",url:g+"search/tv",params:{api_key:h,query:a.query,search_type:"ngram"}}).success(function(b){a.autocompleteTvShows=b.results.splice(0,3)}).error(function(){a.autocompleteTvShows=[]})):(a.autocompleteMovies=[],a.autocompleteTvShows=[],a.autocompletePeople=[])),a.showAutocomplete?k():console.log("Autocomplete disabled")},1e3)};b.$watch("query",function(){a.query=b.query})}]),angular.module("omdbApp").controller("HomeCtrl",["$scope","$rootScope","$http","$location","APIURL","APIKey",function(a,b,c,d,e,f){a.posterPath=b.config.images.base_url+b.config.images.poster_sizes[2],c({method:"GET",url:e+"movie/popular",params:{api_key:f}}).success(function(b){console.log(b),a.popular=b.results,a.popularCount=b.total_results}).error(function(a){console.log(a)}),c({method:"GET",url:e+"movie/now_playing",params:{api_key:f}}).success(function(b){console.log(b),a.playing=b.results,a.playingCount=b.total_results}).error(function(a){console.log(a)})}]),angular.module("omdbApp").controller("SearchCtrl",["$scope","$rootScope","$routeParams","$location","$http","$anchorScroll","APIKey","APIURL",function(a,b,c,d,e,f,g,h){c.query?b.query=c.query:d.path(""),console.log(b.config),a.posterPath=b.config.images.base_url+b.config.images.poster_sizes[1],a.profilePath=b.config.images.base_url+b.config.images.profile_sizes[1],a.movies=[],a.people=[],e({method:"GET",url:h+"search/movie",params:{api_key:g,query:c.query}}).success(function(b){console.log(b),a.movies=b.results,a.moviesCount=b.total_results}).error(function(a){console.log(a)}),e({method:"GET",url:h+"search/tv",params:{api_key:g,query:c.query}}).success(function(b){console.log(b),a.tvShows=b.results,a.tvShowsCount=b.total_results}).error(function(a){console.log(a)}),e({method:"GET",url:h+"search/person",params:{api_key:g,query:c.query}}).success(function(b){console.log(b),a.people=b.results,a.peopleCount=b.total_results}).error(function(a){console.log(a)}),a.details=function(a,b,c){d.path(a+"/"+b.id+"/"+c)},a.scrollTo=function(a){d.hash(a),f()}}]),angular.module("omdbApp").controller("DetailsMovieCtrl",["$scope","$rootScope","$routeParams","$location","$http","$timeout","$sce","APIKey","APIURL",function(a,b,c,d,e,f,g,h,i){c.id||d.path(""),a.type=c.type?c.type:"movie",a.backdropPath=b.config.images.base_url+"original",a.posterPath=b.config.images.base_url+"original",a.profilePath=b.config.images.base_url+b.config.images.profile_sizes[1],e({method:"GET",url:i+a.type+"/"+c.id,params:{api_key:h,append_to_response:"credits,images,similar,videos"}}).success(function(c){console.log(c),a.details=c,a.images=c.images,b.query=c.title||c.name,a.backdrops=[],a.images.backdrops.forEach(function(b){b.width>1e3&&a.backdrops.push(b)}),0!==a.backdrops.length&&(b.translucentMenu=!0),a.backdropIndex=0,a.changeBackdrop(),a.stars=[0,0,0,0,0,0,0,0,0,0];for(var d=a.details.vote_average,e=0;10>e;e++)d>=1?a.stars[e]=2:d>0&&(a.stars[e]=1),d--;a.trailerYoutube=!1,a.showTrailer=!1,a.details.videos.results.forEach(function(b){"YouTube"===b.site&&"Trailer"===b.type&&(a.trailerYoutube=b)})}).error(function(a){console.log(a)}),a.trustSrc=function(a){return g.trustAsResourceUrl(a)},a.showFullOverview=!1,a.toggleFullOverview=function(){a.showFullOverview=!a.showFullOverview},a.changeBackdrop=function(){f(function(){a.backdropIndex<a.backdrops.length-1?a.backdropIndex++:a.backdropIndex=0,a.changeBackdrop()},12e3)},a.prevBackdrop=function(){a.backdropIndex>0?a.backdropIndex--:a.backdropIndex=a.backdrops.length-1},a.nextBackdrop=function(){a.backdropIndex<a.backdrops.length-1?a.backdropIndex++:a.backdropIndex=0},a.$on("$destroy",function(){b.translucentMenu=!1,f.cancel()})}]),angular.module("omdbApp").controller("DetailsPersonCtrl",["$scope","$rootScope","$routeParams","$location","$http","$timeout","APIKey","APIURL",function(a,b,c,d,e,f,g,h){c.id||d.path(""),a.backdropPath=b.config.images.base_url+"original",a.posterPath=b.config.images.base_url+"original",a.profilePath=b.config.images.base_url+b.config.images.profile_sizes[1],e({method:"GET",url:h+"person/"+c.id,params:{api_key:g,append_to_response:"combined_credits,images,tagged_images"}}).success(function(c){console.log(c),a.details=c,a.images=c.images,b.query=c.name,a.backdrops=[],c.tagged_images.results.forEach(function(b){"backdrop"===b.image_type&&a.backdrops.push(b)}),0!==a.backdrops.length&&(b.translucentMenu=!0),a.backdropIndex=0,a.changeBackdrop()}).error(function(a){console.log(a)}),a.showFullBio=!1,a.toggleFullBio=function(){a.showFullBio=!a.showFullBio},a.changeBackdrop=function(){f(function(){a.backdropIndex<a.backdrops.length-1?a.backdropIndex++:a.backdropIndex=0,a.changeBackdrop()},12e3)},a.prevBackdrop=function(){a.backdropIndex>0?a.backdropIndex--:a.backdropIndex=a.backdrops.length-1},a.nextBackdrop=function(){a.backdropIndex<a.backdrops.length-1?a.backdropIndex++:a.backdropIndex=0},a.$on("$destroy",function(){b.translucentMenu=!1,f.cancel()})}]);